# 실시간 통신

## 실시간 통신이란?
실시간 통신(Real-time Communication)은 **클라이언트와 서버가 데이터를 즉각적으로 주고받는 통신 방식**을 의미한다. 
기존 HTTP 요청-응답 모델과 달리 **연결을 유지하며 지속적으로 데이터를 주고받을 수 있다**는 특징이 있다.

---

## HTTP 요청-응답 모델의 한계점
HTTP는 **Stateless(무상태성) 프로토콜**로, 요청과 응답이 끝나면 연결이 끊어진다. 이로 인해 다음과 같은 문제가 발생한다.
- **서버가 클라이언트에게 먼저 데이터를 보낼 수 없음** → 실시간 알림, 채팅 서비스에서 비효율적
- **매 요청마다 새로운 연결을 생성** → 네트워크 트래픽 증가, 서버 부하 발생
- **지연 시간 발생** → 주가 변동 같은 실시간성이 중요한 서비스에 부적합 

이러한 한계를 해결하기 위해 지속적인 연결을 유지하며 데이터를 주고받는 기술이 필요.

---

## 실시간 통신 방식의 종류
### Polling
- 클라이언트가 일정 주기로 서버에 요청을 보내는 방식
- 서버가 즉각적인 응답을 반환하며, 변경된 데이터가 없더라도 똑같은 응답을 반환
- ex): 일정 주기로 뉴스 기사 목록을 갱신하는 서비스

#### 장점
- 별다른 세팅 없이 실시간 처럼 느껴지는 비동기 통신이 가능 
#### 단점
- 서버에 부담이 크고, 불필요한 네트워크 트래픽이 발생함

### Long Polling
- 클라이언트가 요청을 보내면 서버는 응답을 즉시 반환하지 않고, 변경된 데이터가 있을 때까지 응답을 기다렸다가 반환함.
  - 변경된 데이터가 없으면 Timeout 응답을 반환
- ex): 실시간 알림 시스템

#### 장점
- 일반 Polling 방식에 비해서 요청수가 적어 네트워크 부담이 적음  
#### 단점
- 서버 리소스를 계속 점유함 (스레드 / 커넥션 관리 필요).

### WebSocket
- 클라이언트와 서버 간에 지속적인 연결을 유지하며, **양방향 통신을 가능하게 하는 프로토콜**
- HTTP 연결을 업그레이드하여 WebSocket 프로토콜로 변경한 후, Websocket 프레임 단위로 양방향 데이터 전송이 가능
  - ```
    클라이언트가 Http Upgrade 요청을 보냄
    GET /chat HTTP/1.1
    Host: example.com
    Upgrade: websocket
    Connection: Upgrade
    
    서버가 WebSocket 프로토콜로 전환을 승인
    HTTP/1.1 101 Switching Protocols
    Upgrade: websocket
    Connection: Upgrade
    ```
- ex): 채팅 애플리케이션

#### 장점
- 연결 유지 비용이 적으며, 데이터 전송 속도가 빠름

#### 단점
- 일부 네트워크에서 Websocket 방식이 차단될 수 있음
- Websocket 커넥션을 유지해야 하므로 scale-out에 주의 필요


### Server-Sent Events (SSE)
- 서버가 클라이언트에게 **이벤트를 계속 Push 방식**
- 클라이언트는 단 한번만 연결하면 커넥션 만료 시간동안 서버의 이벤트를 지속적으로 수신할 수 있음
- 서버에서 지속적으로 데이터를 푸시할 때 적합 (텍스트 기반)
- ex): 실시간 뉴스 피드, 서버 모니터링

#### 장점
- 서버가 클라이언트에게 자유롭게 데이터 push 가능
- HTTP 기반이므로 프록시 / 방화벽에서 발생하는 문제가 적음

#### 단점
- IE/ Edge (구버전) 미지원
- 브라우저당 연결 수 제한이 있음
  - HTTP/1.1에서는 브라우저당 최대 6개 연결 제한

## 결론
간단한 데이터 갱신 → Polling / Long Polling  
양방향 실시간 통신 → WebSocket  
단방향 서버 푸시 → SSE